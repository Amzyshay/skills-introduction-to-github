<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CareFlow Pro - Advanced Care Management Platform</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary-color: #CBC3E3;
            --secondary-color: #CF9FFF;
            --accent-color: #E6E6FA;
            --text-dark: #2d2d2d;
            --text-light: #666;
            --success: #4CAF50;
            --warning: #FF9800;
            --error: #f44336;
            --white: #ffffff;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, var(--accent-color) 0%, var(--primary-color) 100%);
            min-height: 100vh;
            color: var(--text-dark);
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            background: var(--white);
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
        }

        .logo {
            font-size: 2.5em;
            font-weight: bold;
            background: linear-gradient(45deg, var(--secondary-color), var(--primary-color));
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .user-info {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .user-avatar {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: var(--secondary-color);
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--white);
            font-weight: bold;
            cursor: pointer;
        }

        .nav-tabs {
            background: var(--white);
            border-radius: 15px;
            padding: 5px;
            margin-bottom: 20px;
            display: flex;
            gap: 5px;
            overflow-x: auto;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
        }

        .nav-tab {
            padding: 15px 25px;
            border-radius: 10px;
            border: none;
            background: transparent;
            color: var(--text-light);
            cursor: pointer;
            transition: all 0.3s ease;
            white-space: nowrap;
            font-weight: 500;
        }

        .nav-tab.active {
            background: linear-gradient(45deg, var(--secondary-color), var(--primary-color));
            color: var(--white);
        }

        .nav-tab:hover {
            background: var(--accent-color);
            color: var(--text-dark);
        }

        .nav-tab.active:hover {
            background: linear-gradient(45deg, var(--secondary-color), var(--primary-color));
            color: var(--white);
        }

        .content {
            background: var(--white);
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
            min-height: 600px;
        }

        .hidden {
            display: none;
        }

        .dashboard-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .dashboard-card {
            background: linear-gradient(135deg, var(--accent-color), var(--primary-color));
            border-radius: 15px;
            padding: 25px;
            text-align: center;
            transition: transform 0.3s ease;
        }

        .dashboard-card:hover {
            transform: translateY(-5px);
        }

        .dashboard-card h3 {
            font-size: 2.5em;
            margin-bottom: 10px;
            color: var(--text-dark);
        }

        .dashboard-card p {
            color: var(--text-light);
            font-size: 1.1em;
        }

        .btn-primary {
            background: linear-gradient(45deg, var(--secondary-color), var(--primary-color));
            color: var(--white);
            border: none;
            padding: 12px 25px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1em;
            font-weight: 500;
            transition: all 0.3s ease;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(207, 159, 255, 0.4);
        }

        .btn-secondary {
            background: var(--accent-color);
            color: var(--text-dark);
            border: 2px solid var(--primary-color);
            padding: 10px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.9em;
            transition: all 0.3s ease;
        }

        .btn-secondary:hover {
            background: var(--primary-color);
            color: var(--white);
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: 500;
            color: var(--text-dark);
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid var(--accent-color);
            border-radius: 8px;
            font-size: 1em;
            transition: border-color 0.3s ease;
        }

        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: var(--secondary-color);
        }

        .table-container {
            overflow-x: auto;
            margin-top: 20px;
        }

        .data-table {
            width: 100%;
            border-collapse: collapse;
            background: var(--white);
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .data-table th {
            background: linear-gradient(45deg, var(--secondary-color), var(--primary-color));
            color: var(--white);
            padding: 15px;
            text-align: left;
            font-weight: 600;
        }

        .data-table td {
            padding: 15px;
            border-bottom: 1px solid var(--accent-color);
        }

        .data-table tr:hover {
            background: var(--accent-color);
        }

        .status-badge {
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 0.8em;
            font-weight: bold;
            text-align: center;
            display: inline-block;
            min-width: 80px;
        }

        .status-active {
            background: var(--success);
            color: var(--white);
        }

        .status-pending {
            background: var(--warning);
            color: var(--white);
        }

        .status-inactive {
            background: var(--error);
            color: var(--white);
        }

        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5);
        }

        .modal-content {
            background-color: var(--white);
            margin: 5% auto;
            padding: 30px;
            border-radius: 15px;
            width: 90%;
            max-width: 600px;
            max-height: 80vh;
            overflow-y: auto;
        }

        .close {
            color: var(--text-light);
            float: right;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
        }

        .close:hover {
            color: var(--text-dark);
        }

        .rota-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 10px;
            margin-top: 20px;
        }

        .rota-day {
            background: var(--accent-color);
            border-radius: 8px;
            padding: 15px;
            min-height: 200px;
            text-align: center;
        }

        .rota-day h4 {
            margin-bottom: 10px;
            color: var(--text-dark);
        }

        .shift-item {
            background: var(--secondary-color);
            color: var(--white);
            padding: 8px;
            border-radius: 5px;
            margin-bottom: 5px;
            font-size: 0.8em;
            cursor: pointer;
        }

        .profile-image-container {
            position: relative;
            width: 100px;
            height: 100px;
            margin: 20px auto;
        }

        .profile-image {
            width: 100%;
            height: 100%;
            border-radius: 50%;
            object-fit: cover;
            background: var(--accent-color);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2em;
            color: var(--text-dark);
        }

        .upload-btn {
            position: absolute;
            bottom: 0;
            right: 0;
            background: var(--secondary-color);
            color: var(--white);
            border: none;
            border-radius: 50%;
            width: 30px;
            height: 30px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .search-bar {
            background: var(--accent-color);
            border: 2px solid var(--primary-color);
            border-radius: 25px;
            padding: 12px 20px;
            width: 100%;
            max-width: 400px;
            margin-bottom: 20px;
            font-size: 1em;
        }

        .search-bar:focus {
            outline: none;
            border-color: var(--secondary-color);
        }

        .alert {
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            font-weight: 500;
        }

        .alert-success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }

        .alert-warning {
            background: #fff3cd;
            color: #856404;
            border: 1px solid #ffeaa7;
        }

        .alert-error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }

        .stats-row {
            display: flex;
            gap: 20px;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }

        .stat-card {
            flex: 1;
            min-width: 200px;
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: var(--white);
            padding: 20px;
            border-radius: 12px;
            text-align: center;
        }

        .stat-number {
            font-size: 2.5em;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .stat-label {
            font-size: 0.9em;
            opacity: 0.9;
        }

        @media (max-width: 768px) {
            .header {
                flex-direction: column;
                gap: 15px;
                text-align: center;
            }

            .nav-tabs {
                flex-wrap: wrap;
            }

            .dashboard-grid {
                grid-template-columns: 1fr;
            }

            .rota-grid {
                grid-template-columns: 1fr;
            }

            .stats-row {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header class="header">
            <div class="logo">CareFlow Pro</div>
            <div class="user-info">
                <span id="currentUser">Admin User</span>
                <div class="user-avatar" onclick="showProfileModal()">AU</div>
                <button class="btn-secondary" onclick="logout()">Logout</button>
            </div>
        </header>

        <nav class="nav-tabs">
            <button class="nav-tab active" onclick="showTab('dashboard')">Dashboard</button>
            <button class="nav-tab" onclick="showTab('clients')">Clients</button>
            <button class="nav-tab" onclick="showTab('staff')">Staff</button>
            <button class="nav-tab" onclick="showTab('rota')">Rota Management</button>
            <button class="nav-tab" onclick="showTab('care-plans')">Care Plans</button>
            <button class="nav-tab" onclick="showTab('incidents')">Incidents</button>
            <button class="nav-tab" onclick="showTab('reports')">Reports</button>
            <button class="nav-tab" onclick="showTab('settings')">Settings</button>
        </nav>

        <main class="content">
            <!-- Dashboard Tab -->
            <div id="dashboard" class="tab-content">
                <h2 style="margin-bottom: 30px; color: var(--text-dark);">Dashboard Overview</h2>
                
                <div class="stats-row">
                    <div class="stat-card">
                        <div class="stat-number" id="totalClients">0</div>
                        <div class="stat-label">Total Clients</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="totalStaff">0</div>
                        <div class="stat-label">Active Staff</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="todayShifts">0</div>
                        <div class="stat-label">Today's Shifts</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="pendingIncidents">0</div>
                        <div class="stat-label">Pending Incidents</div>
                    </div>
                </div>

                <div class="dashboard-grid">
                    <div class="dashboard-card">
                        <h3>📋</h3>
                        <p>Care Plans Active</p>
                    </div>
                    <div class="dashboard-card">
                        <h3>🏥</h3>
                        <p>Medication Reviews Due</p>
                    </div>
                    <div class="dashboard-card">
                        <h3>⚠️</h3>
                        <p>Risk Assessments</p>
                    </div>
                    <div class="dashboard-card">
                        <h3>📊</h3>
                        <p>Compliance Score: 98%</p>
                    </div>
                </div>

                <div class="alert alert-warning">
                    <strong>Attention:</strong> 3 medication reviews are due this week. Please review and update care plans accordingly.
                </div>
            </div>

            <!-- Clients Tab -->
            <div id="clients" class="tab-content hidden">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; flex-wrap: wrap; gap: 15px;">
                    <h2>Client Management</h2>
                    <button class="btn-primary" onclick="showAddClientModal()">Add New Client</button>
                </div>

                <input type="text" class="search-bar" placeholder="Search clients..." oninput="searchClients(this.value)">

                <div class="table-container">
                    <table class="data-table" id="clientsTable">
                        <thead>
                            <tr>
                                <th>Name</th>
                                <th>Age</th>
                                <th>Care Type</th>
                                <th>Status</th>
                                <th>Last Visit</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="clientsTableBody">
                            <!-- Client data will be populated here -->
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Staff Tab -->
            <div id="staff" class="tab-content hidden">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; flex-wrap: wrap; gap: 15px;">
                    <h2>Staff Management</h2>
                    <button class="btn-primary" onclick="showAddStaffModal()">Add New Staff</button>
                </div>

                <input type="text" class="search-bar" placeholder="Search staff..." oninput="searchStaff(this.value)">

                <div class="table-container">
                    <table class="data-table" id="staffTable">
                        <thead>
                            <tr>
                                <th>Photo</th>
                                <th>Name</th>
                                <th>Role</th>
                                <th>Qualifications</th>
                                <th>Status</th>
                                <th>Contact</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="staffTableBody">
                            <!-- Staff data will be populated here -->
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Rota Management Tab -->
            <div id="rota" class="tab-content hidden">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; flex-wrap: wrap; gap: 15px;">
                    <h2>Rota Management</h2>
                    <div>
                        <button class="btn-secondary" onclick="generateSmartRota()">🤖 Auto Generate</button>
                        <button class="btn-primary" onclick="showAddShiftModal()">Add Shift</button>
                    </div>
                </div>

                <div style="margin-bottom: 20px;">
                    <label>Week Starting: </label>
                    <input type="date" id="rotaWeek" onchange="updateRotaView()" style="padding: 8px; border-radius: 5px; border: 2px solid var(--accent-color);">
                </div>

                <div class="rota-grid" id="rotaGrid">
                    <!-- Rota grid will be populated here -->
                </div>
            </div>

            <!-- Care Plans Tab -->
            <div id="care-plans" class="tab-content hidden">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; flex-wrap: wrap; gap: 15px;">
                    <h2>Care Plans</h2>
                    <button class="btn-primary" onclick="showAddCarePlanModal()">Create Care Plan</button>
                </div>

                <div class="table-container">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Client</th>
                                <th>Care Type</th>
                                <th>Created Date</th>
                                <th>Last Updated</th>
                                <th>Status</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="carePlansTableBody">
                            <!-- Care plans data will be populated here -->
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Incidents Tab -->
            <div id="incidents" class="tab-content hidden">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; flex-wrap: wrap; gap: 15px;">
                    <h2>Incident Reports</h2>
                    <button class="btn-primary" onclick="showAddIncidentModal()">Report Incident</button>
                </div>

                <div class="table-container">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Date/Time</th>
                                <th>Client</th>
                                <th>Type</th>
                                <th>Severity</th>
                                <th>Reported By</th>
                                <th>Status</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="incidentsTableBody">
                            <!-- Incidents data will be populated here -->
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Reports Tab -->
            <div id="reports" class="tab-content hidden">
                <h2 style="margin-bottom: 30px;">Reports & Analytics</h2>

                <div class="dashboard-grid">
                    <div class="dashboard-card" onclick="generateReport('care-logs')">
                        <h3>📝</h3>
                        <p>Care Logs Report</p>
                    </div>
                    <div class="dashboard-card" onclick="generateReport('medication')">
                        <h3>💊</h3>
                        <p>Medication Report</p>
                    </div>
                    <div class="dashboard-card" onclick="generateReport('incidents')">
                        <h3>⚠️</h3>
                        <p>Incident Analysis</p>
                    </div>
                    <div class="dashboard-card" onclick="generateReport('staff-hours')">
                        <h3>⏰</h3>
                        <p>Staff Hours Report</p>
                    </div>
                    <div class="dashboard-card" onclick="generateReport('compliance')">
                        <h3>✅</h3>
                        <p>Compliance Report</p>
                    </div>
                    <div class="dashboard-card" onclick="generateReport('custom')">
                        <h3>📊</h3>
                        <p>Custom Report</p>
                    </div>
                </div>
            </div>

            <!-- Settings Tab -->
            <div id="settings" class="tab-content hidden">
                <h2 style="margin-bottom: 30px;">System Settings</h2>

                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 30px;">
                    <div style="background: var(--accent-color); padding: 25px; border-radius: 12px;">
                        <h3>System Information</h3>
                        <p><strong>Version:</strong> 1.0.0</p>
                        <p><strong>Last Backup:</strong> <span id="lastBackup">Today 03:00</span></p>
                        <p><strong>Users:</strong> <span id="userCount">25</span>/100</p>
                        <p><strong>Storage Used:</strong> 2.3GB/10GB</p>
                        <button class="btn-primary" style="margin-top: 15px;" onclick="performBackup()">Backup Now</button>
                    </div>

                    <div style="background: var(--accent-color); padding: 25px; border-radius: 12px;">
                        <h3>Security Settings</h3>
                        <div class="form-group">
                            <label>
                                <input type="checkbox" checked> Require 2FA for all users
                            </label>
                        </div>
                        <div class="form-group">
                            <label>
                                <input type="checkbox" checked> Auto-logout after 30 minutes
                            </label>
                        </div>
                        <div class="form-group">
                            <label>
                                <input type="checkbox"> Enable login notifications
                            </label>
                        </div>
                        <button class="btn-primary">Save Security Settings</button>
                    </div>

                    <div style="background: var(--accent-color); padding: 25px; border-radius: 12px;">
                        <h3>Notification Settings</h3>
                        <div class="form-group">
                            <label>
                                <input type="checkbox" checked> Email notifications
                            </label>
                        </div>
                        <div class="form-group">
                            <label>
                                <input type="checkbox" checked> SMS alerts for emergencies
                            </label>
                        </div>
                        <div class="form-group">
                            <label>
                                <input type="checkbox"> Push notifications
                            </label>
                        </div>
                        <button class="btn-primary">Save Notification Settings</button>
                    </div>

                    <div style="background: var(--accent-color); padding: 25px; border-radius: 12px;">
                        <h3>Data Management</h3>
                        <button class="btn-secondary" style="margin: 5px;">Export All Data</button>
                        <button class="btn-secondary" style="margin: 5px;">Import Data</button>
                        <button class="btn-secondary" style="margin: 5px;">Archive Old Records</button>
                        <button class="btn-primary" style="margin: 5px;">Data Cleanup</button>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- Modals -->
    <!-- Add Client Modal -->
    <div id="addClientModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal('addClientModal')">&times;</span>
            <h2>Add New Client</h2>
            <form id="addClientForm">
                <div class="profile-image-container">
                    <div class="profile-image" id="clientProfilePreview">👤</div>
                    <button type="button" class="upload-btn" onclick="document.getElementById('clientImageUpload').click()">📷</button>
                    <input type="file" id="clientImageUpload" accept="image/*" style="display: none;" onchange="previewImage(this, 'clientProfilePreview')">
                </div>
                
                <div class="form-group">
                    <label>Full Name</label>
                    <input type="text" id="clientName" required>
                </div>
                <div class="form-group">
                    <label>Date of Birth</label>
                    <input type="date" id="clientDOB" required>
                </div>
                <div class="form-group">
                    <label>Care Type</label>
                    <select id="clientCareType" required>
                        <option value="">Select Care Type</option>
                        <option value="Residential">Residential Care</option>
                        <option value="Domiciliary">Domiciliary Care</option>
                        <option value="Supported Living">Supported Living</option>
                        <option value="Respite">Respite Care</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Address</label>
                    <textarea id="clientAddress" rows="3"></textarea>
                </div>
                <div class="form-group">
                    <label>Emergency Contact</label>
                    <input type="text" id="clientEmergencyContact">
                </div>
                <div class="form-group">
                    <label>Medical Conditions</label>
                    <textarea id="clientMedicalConditions" rows="3"></textarea>
                </div>
                <button type="submit" class="btn-primary">Add Client</button>
            </form>
        </div>
    </div>

    <!-- Add Staff Modal -->
    <div id="addStaffModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal('addStaffModal')">&times;</span>
            <h2>Add New Staff Member</h2>
            <form id="addStaffForm">
                <div class="profile-image-container">
                    <div class="profile-image" id="staffProfilePreview">👤</div>
                    <button type="button" class="upload-btn" onclick="document.getElementById('staffImageUpload').click()">📷</button>
                    <input type="file" id="staffImageUpload" accept="image/*" style="display: none;" onchange="previewImage(this, 'staffProfilePreview')">
                </div>
                
                <div class="form-group">
                    <label>Full Name</label>
                    <input type="text" id="staffName" required>
                </div>
                <div class="form-group">
                    <label>Role</label>
                    <select id="staffRole" required>
                        <option value="">Select Role</option>
                        <option value="Carer">Carer</option>
                        <option value="Senior Carer">Senior Carer</option>
                        <option value="Manager">Manager</option>
                        <option value="Administrator">Administrator</option>
                        <option value="Nurse">Nurse</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Email</label>
                    <input type="email" id="staffEmail" required>
                </div>
                <div class="form-group">
                    <label>Phone</label>
                    <input type="tel" id="staffPhone" required>
                </div>
                <div class="form-group">
                    <label>Qualifications</label>
                    <textarea id="staffQualifications" rows="3" placeholder="e.g., NVQ Level 3, First Aid, Dementia Care"></textarea>
                </div>
                <div class="form-group">
                    <label>Start Date</label>
                    <input type="date" id="staffStartDate" required>
                </div>
                <div class="form-group">
                    <label>DBS Check Date</label>
                    <input type="date" id="staffDBSDate">
                </div>
                <button type="submit" class="btn-primary">Add Staff Member</button>
            </form>
        </div>
    </div>

    <!-- Add Shift Modal -->
    <div id="addShiftModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal('addShiftModal')">&times;</span>
            <h2>Add New Shift</h2>
            <form id="addShiftForm">
                <div class="form-group">
                    <label>Staff Member</label>
                    <select id="shiftStaff" required>
                        <option value="">Select Staff Member</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Client</label>
                    <select id="shiftClient" required>
                        <option value="">Select Client</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Date</label>
                    <input type="date" id="shiftDate" required>
                </div>
                <div class="form-group">
                    <label>Start Time</label>
                    <input type="time" id="shiftStartTime" required>
                </div>
                <div class="form-group">
                    <label>End Time</label>
                    <input type="time" id="shiftEndTime" required>
                </div>
                <div class="form-group">
                    <label>Shift Type</label>
                    <select id="shiftType" required>
                        <option value="">Select Type</option>
                        <option value="Regular">Regular Care</option>
                        <option value="Personal Care">Personal Care</option>
                        <option value="Medication">Medication Support</option>
                        <option value="Companionship">Companionship</option>
                        <option value="Night Care">Night Care</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Notes</label>
                    <textarea id="shiftNotes" rows="3"></textarea>
                </div>
                <button type="submit" class="btn-primary">Add Shift</button>
            </form>
        </div>
    </div>

    <!-- Profile Modal -->
    <div id="profileModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal('profileModal')">&times;</span>
            <h2>User Profile</h2>
            <div class="profile-image-container">
                <div class="profile-image" id="userProfileImage">AU</div>
                <button type="button" class="upload-btn" onclick="document.getElementById('userImageUpload').click()">📷</button>
                <input type="file" id="userImageUpload" accept="image/*" style="display: none;" onchange="previewImage(this, 'userProfileImage')">
            </div>
            <form id="profileForm">
                <div class="form-group">
                    <label>Full Name</label>
                    <input type="text" id="profileName" value="Admin User">
                </div>
                <div class="form-group">
                    <label>Email</label>
                    <input type="email" id="profileEmail" value="admin@careflow.com">
                </div>
                <div class="form-group">
                    <label>Role</label>
                    <select id="profileRole">
                        <option value="Administrator" selected>Administrator</option>
                        <option value="Manager">Manager</option>
                        <option value="Supervisor">Supervisor</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Phone</label>
                    <input type="tel" id="profilePhone" value="+44 20 1234 5678">
                </div>
                <button type="submit" class="btn-primary">Update Profile</button>
            </form>
        </div>
    </div>

    <script>
        // Data Storage
        let clients = JSON.parse(localStorage.getItem('careflow_clients') || '[]');
        let staff = JSON.parse(localStorage.getItem('careflow_staff') || '[]');
        let shifts = JSON.parse(localStorage.getItem('careflow_shifts') || '[]');
        let carePlans = JSON.parse(localStorage.getItem('careflow_careplans') || '[]');
        let incidents = JSON.parse(localStorage.getItem('careflow_incidents') || '[]');

        // Initialize the application
        document.addEventListener('DOMContentLoaded', function() {
            initializeApp();
            updateDashboardStats();
            populateClientTable();
            populateStaffTable();
            updateRotaView();
            setDefaultDate();
        });

        function initializeApp() {
            // Initialize with sample data if empty
            if (clients.length === 0) {
                clients = [
                    {
                        id: 1,
                        name: "Margaret Johnson",
                        age: 78,
                        careType: "Residential",
                        status: "Active",
                        lastVisit: "2025-06-05",
                        address: "123 Oak Street, London",
                        emergencyContact: "John Johnson - 07123456789",
                        medicalConditions: "Diabetes, Hypertension",
                        image: null
                    },
                    {
                        id: 2,
                        name: "Robert Smith",
                        age: 82,
                        careType: "Domiciliary",
                        status: "Active",
                        lastVisit: "2025-06-04",
                        address: "456 Elm Avenue, Brighton",
                        emergencyContact: "Sarah Smith - 07987654321",
                        medicalConditions: "Dementia, Arthritis",
                        image: null
                    }
                ];
                saveClients();
            }

            if (staff.length === 0) {
                staff = [
                    {
                        id: 1,
                        name: "Emma Wilson",
                        role: "Senior Carer",
                        email: "emma.wilson@careflow.com",
                        phone: "07111222333",
                        qualifications: "NVQ Level 3, First Aid, Dementia Care",
                        status: "Active",
                        startDate: "2023-01-15",
                        dbsDate: "2024-01-15",
                        image: null
                    },
                    {
                        id: 2,
                        name: "James Taylor",
                        role: "Carer",
                        email: "james.taylor@careflow.com",
                        phone: "07444555666",
                        qualifications: "NVQ Level 2, First Aid",
                        status: "Active",
                        startDate: "2023-06-01",
                        dbsDate: "2024-06-01",
                        image: null
                    }
                ];
                saveStaff();
            }
        }

        // Tab Management
        function showTab(tabName) {
            // Hide all tab contents
            const tabContents = document.querySelectorAll('.tab-content');
            tabContents.forEach(tab => tab.classList.add('hidden'));

            // Remove active class from all tabs
            const tabs = document.querySelectorAll('.nav-tab');
            tabs.forEach(tab => tab.classList.remove('active'));

            // Show selected tab and mark as active
            document.getElementById(tabName).classList.remove('hidden');
            event.target.classList.add('active');

            // Update content based on tab
            if (tabName === 'rota') {
                updateRotaView();
            }
        }

        // Modal Management
        function showModal(modalId) {
            document.getElementById(modalId).style.display = 'block';
        }

        function closeModal(modalId) {
            document.getElementById(modalId).style.display = 'none';
        }

        function showAddClientModal() {
            showModal('addClientModal');
        }

        function showAddStaffModal() {
            populateStaffDropdown();
            showModal('addStaffModal');
        }

        function showAddShiftModal() {
            populateShiftDropdowns();
            showModal('addShiftModal');
        }

        function showProfileModal() {
            showModal('profileModal');
        }

        // Close modals when clicking outside
        window.onclick = function(event) {
            const modals = document.querySelectorAll('.modal');
            modals.forEach(modal => {
                if (event.target === modal) {
                    modal.style.display = 'none';
                }
            });
        }

        // Image Upload and Preview
        function previewImage(input, previewId) {
            if (input.files && input.files[0]) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    const preview = document.getElementById(previewId);
                    preview.innerHTML = `<img src="${e.target.result}" alt="Profile" style="width: 100%; height: 100%; object-fit: cover; border-radius: 50%;">`;
                };
                reader.readAsDataURL(input.files[0]);
            }
        }

        // Client Management
        function saveClients() {
            localStorage.setItem('careflow_clients', JSON.stringify(clients));
        }

        function populateClientTable() {
            const tbody = document.getElementById('clientsTableBody');
            tbody.innerHTML = '';

            clients.forEach(client => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${client.name}</td>
                    <td>${client.age}</td>
                    <td>${client.careType}</td>
                    <td><span class="status-badge status-${client.status.toLowerCase()}">${client.status}</span></td>
                    <td>${formatDate(client.lastVisit)}</td>
                    <td>
                        <button class="btn-secondary" onclick="editClient(${client.id})">Edit</button>
                        <button class="btn-secondary" onclick="deleteClient(${client.id})" style="background: var(--error); color: var(--white);">Delete</button>
                    </td>
                `;
                tbody.appendChild(row);
            });
        }

        function addClient(formData) {
            const newClient = {
                id: Date.now(),
                name: formData.get('name'),
                age: calculateAge(formData.get('dob')),
                careType: formData.get('careType'),
                status: 'Active',
                lastVisit: new Date().toISOString().split('T')[0],
                address: formData.get('address'),
                emergencyContact: formData.get('emergencyContact'),
                medicalConditions: formData.get('medicalConditions'),
                image: null
            };

            clients.push(newClient);
            saveClients();
            populateClientTable();
            updateDashboardStats();
            closeModal('addClientModal');
            showAlert('Client added successfully!', 'success');
        }

        function editClient(clientId) {
            const client = clients.find(c => c.id === clientId);
            // Implementation for editing client
            showAlert('Edit functionality - Coming Soon!', 'warning');
        }

        function deleteClient(clientId) {
            if (confirm('Are you sure you want to delete this client?')) {
                clients = clients.filter(c => c.id !== clientId);
                saveClients();
                populateClientTable();
                updateDashboardStats();
                showAlert('Client deleted successfully!', 'success');
            }
        }

        function searchClients(searchTerm) {
            const filteredClients = clients.filter(client =>
                client.name.toLowerCase().includes(searchTerm.toLowerCase()) ||
                client.careType.toLowerCase().includes(searchTerm.toLowerCase())
            );
            
            const tbody = document.getElementById('clientsTableBody');
            tbody.innerHTML = '';

            filteredClients.forEach(client => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${client.name}</td>
                    <td>${client.age}</td>
                    <td>${client.careType}</td>
                    <td><span class="status-badge status-${client.status.toLowerCase()}">${client.status}</span></td>
                    <td>${formatDate(client.lastVisit)}</td>
                    <td>
                        <button class="btn-secondary" onclick="editClient(${client.id})">Edit</button>
                        <button class="btn-secondary" onclick="deleteClient(${client.id})" style="background: var(--error); color: var(--white);">Delete</button>
                    </td>
                `;
                tbody.appendChild(row);
            });
        }

        // Staff Management
        function saveStaff() {
            localStorage.setItem('careflow_staff', JSON.stringify(staff));
        }

        function populateStaffTable() {
            const tbody = document.getElementById('staffTableBody');
            tbody.innerHTML = '';

            staff.forEach(member => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>
                        <div style="width: 40px; height: 40px; border-radius: 50%; background: var(--accent-color); display: flex; align-items: center; justify-content: center; font-weight: bold;">
                            ${member.image ? `<img src="${member.image}" style="width: 100%; height: 100%; border-radius: 50%; object-fit: cover;">` : member.name.split(' ').map(n => n[0]).join('')}
                        </div>
                    </td>
                    <td>${member.name}</td>
                    <td>${member.role}</td>
                    <td>${member.qualifications}</td>
                    <td><span class="status-badge status-${member.status.toLowerCase()}">${member.status}</span></td>
                    <td>${member.phone}</td>
                    <td>
                        <button class="btn-secondary" onclick="editStaff(${member.id})">Edit</button>
                        <button class="btn-secondary" onclick="deleteStaff(${member.id})" style="background: var(--error); color: var(--white);">Delete</button>
                    </td>
                `;
                tbody.appendChild(row);
            });
        }

        function addStaff(formData) {
            const newStaff = {
                id: Date.now(),
                name: formData.get('name'),
                role: formData.get('role'),
                email: formData.get('email'),
                phone: formData.get('phone'),
                qualifications: formData.get('qualifications'),
                status: 'Active',
                startDate: formData.get('startDate'),
                dbsDate: formData.get('dbsDate'),
                image: null
            };

            staff.push(newStaff);
            saveStaff();
            populateStaffTable();
            updateDashboardStats();
            closeModal('addStaffModal');
            showAlert('Staff member added successfully!', 'success');
        }

        function editStaff(staffId) {
            const staffMember = staff.find(s => s.id === staffId);
            showAlert('Edit functionality - Coming Soon!', 'warning');
        }

        function deleteStaff(staffId) {
            if (confirm('Are you sure you want to delete this staff member?')) {
                staff = staff.filter(s => s.id !== staffId);
                saveStaff();
                populateStaffTable();
                updateDashboardStats();
                showAlert('Staff member deleted successfully!', 'success');
            }
        }

        function searchStaff(searchTerm) {
            const filteredStaff = staff.filter(member =>
                member.name.toLowerCase().includes(searchTerm.toLowerCase()) ||
                member.role.toLowerCase().includes(searchTerm.toLowerCase())
            );
            
            const tbody = document.getElementById('staffTableBody');
            tbody.innerHTML = '';

            filteredStaff.forEach(member => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>
                        <div style="width: 40px; height: 40px; border-radius: 50%; background: var(--accent-color); display: flex; align-items: center; justify-content: center; font-weight: bold;">
                            ${member.image ? `<img src="${member.image}" style="width: 100%; height: 100%; border-radius: 50%; object-fit: cover;">` : member.name.split(' ').map(n => n[0]).join('')}
                        </div>
                    </td>
                    <td>${member.name}</td>
                    <td>${member.role}</td>
                    <td>${member.qualifications}</td>
                    <td><span class="status-badge status-${member.status.toLowerCase()}">${member.status}</span></td>
                    <td>${member.phone}</td>
                    <td>
                        <button class="btn-secondary" onclick="editStaff(${member.id})">Edit</button>
                        <button class="btn-secondary" onclick="deleteStaff(${member.id})" style="background: var(--error); color: var(--white);">Delete</button>
                    </td>
                `;
                tbody.appendChild(row);
            });
        }

        // Rota Management
        function setDefaultDate() {
            const today = new Date();
            const monday = new Date(today.setDate(today.getDate() - today.getDay() + 1));
            document.getElementById('rotaWeek').valueAsDate = monday;
        }

        function updateRotaView() {
            const weekStart = new Date(document.getElementById('rotaWeek').value);
            const rotaGrid = document.getElementById('rotaGrid');
            rotaGrid.innerHTML = '';

            const days = ['Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday', 'Sunday'];
            
            for (let i = 0; i < 7; i++) {
                const currentDate = new Date(weekStart);
                currentDate.setDate(weekStart.getDate() + i);
                
                const dayDiv = document.createElement('div');
                dayDiv.className = 'rota-day';
                dayDiv.innerHTML = `
                    <h4>${days[i]}</h4>
                    <p>${formatDate(currentDate.toISOString().split('T')[0])}</p>
                    <div id="shifts-${i}"></div>
                `;
                
                rotaGrid.appendChild(dayDiv);
                
                // Add sample shifts
                const shiftsContainer = document.getElementById(`shifts-${i}`);
                if (shifts.length > 0) {
                    const dayShifts = shifts.filter(shift => 
                        new Date(shift.date).toDateString() === currentDate.toDateString()
                    );
                    
                    dayShifts.forEach(shift => {
                        const shiftDiv = document.createElement('div');
                        shiftDiv.className = 'shift-item';
                        shiftDiv.innerHTML = `${shift.staffName}<br>${shift.startTime}-${shift.endTime}`;
                        shiftsContainer.appendChild(shiftDiv);
                    });
                }
            }
        }

        function generateSmartRota() {
            showAlert('Smart rota generation started! This may take a few moments...', 'success');
            
            // Simulate smart rota generation
            setTimeout(() => {
                const generatedShifts = generateSampleShifts();
                shifts = [...shifts, ...generatedShifts];
                localStorage.setItem('careflow_shifts', JSON.stringify(shifts));
                updateRotaView();
                showAlert('Smart rota generated successfully! Staff assigned based on availability and proximity.', 'success');
            }, 2000);
        }

        function generateSampleShifts() {
            const sampleShifts = [];
            const weekStart = new Date(document.getElementById('rotaWeek').value);
            
            for (let day = 0; day < 7; day++) {
                const shiftDate = new Date(weekStart);
                shiftDate.setDate(weekStart.getDate() + day);
                
                // Generate 2-3 shifts per day
                for (let shift = 0; shift < Math.floor(Math.random() * 2) + 2; shift++) {
                    const staffMember = staff[Math.floor(Math.random() * staff.length)];
                    const client = clients[Math.floor(Math.random() * clients.length)];
                    
                    if (staffMember && client) {
                        sampleShifts.push({
                            id: Date.now() + day + shift,
                            staffId: staffMember.id,
                            staffName: staffMember.name,
                            clientId: client.id,
                            clientName: client.name,
                            date: shiftDate.toISOString().split('T')[0],
                            startTime: ['08:00', '14:00', '20:00'][shift % 3],
                            endTime: ['14:00', '20:00', '08:00'][shift % 3],
                            type: 'Regular',
                            status: 'Scheduled'
                        });
                    }
                }
            }
            
            return sampleShifts;
        }

        function populateShiftDropdowns() {
            const staffSelect = document.getElementById('shiftStaff');
            const clientSelect = document.getElementById('shiftClient');
            
            staffSelect.innerHTML = '<option value="">Select Staff Member</option>';
            clientSelect.innerHTML = '<option value="">Select Client</option>';
            
            staff.forEach(member => {
                const option = document.createElement('option');
                option.value = member.id;
                option.textContent = member.name;
                staffSelect.appendChild(option);
            });
            
            clients.forEach(client => {
                const option = document.createElement('option');
                option.value = client.id;
                option.textContent = client.name;
                clientSelect.appendChild(option);
            });
        }

        // Dashboard Stats
        function updateDashboardStats() {
            document.getElementById('totalClients').textContent = clients.length;
            document.getElementById('totalStaff').textContent = staff.filter(s => s.status === 'Active').length;
            document.getElementById('todayShifts').textContent = shifts.filter(s => s.date === new Date().toISOString().split('T')[0]).length;
            document.getElementById('pendingIncidents').textContent = incidents.filter(i => i.status === 'Pending').length;
        }

        // Utility Functions
        function calculateAge(birthDate) {
            const today = new Date();
            const birth = new Date(birthDate);
            let age = today.getFullYear() - birth.getFullYear();
            const monthDiff = today.getMonth() - birth.getMonth();
            
            if (monthDiff < 0 || (monthDiff === 0 && today.getDate() < birth.getDate())) {
                age--;
            }
            
            return age;
        }

        function formatDate(dateString) {
            const options = { year: 'numeric', month: 'short', day: 'numeric' };
            return new Date(dateString).toLocaleDateString('en-GB', options);
        }

        function showAlert(message, type) {
            const alertDiv = document.createElement('div');
            alertDiv.className = `alert alert-${type}`;
            alertDiv.textContent = message;
            
            const content = document.querySelector('.content');
            content.insertBefore(alertDiv, content.firstChild);
            
            setTimeout(() => {
                alertDiv.remove();
            }, 5000);
        }

        // Form Handlers
        document.addEventListener('submit', function(e) {
            e.preventDefault();
            
            if (e.target.id === 'addClientForm') {
                const formData = new FormData(e.target);
                formData.set('name', document.getElementById('clientName').value);
                formData.set('dob', document.getElementById('clientDOB').value);
                formData.set('careType', document.getElementById('clientCareType').value);
                formData.set('address', document.getElementById('clientAddress').value);
                formData.set('emergencyContact', document.getElementById('clientEmergencyContact').value);
                formData.set('medicalConditions', document.getElementById('clientMedicalConditions').value);
                
                addClient(formData);
                e.target.reset();
            }
            
            if (e.target.id === 'addStaffForm') {
                const formData = new FormData(e.target);
                formData.set('name', document.getElementById('staffName').value);
                formData.set('role', document.getElementById('staffRole').value);
                formData.set('email', document.getElementById('staffEmail').value);
                formData.set('phone', document.getElementById('staffPhone').value);
                formData.set('qualifications', document.getElementById('staffQualifications').value);
                formData.set('startDate', document.getElementById('staffStartDate').value);
                formData.set('dbsDate', document.getElementById('staffDBSDate').value);
                
                addStaff(formData);
                e.target.reset();
            }
            
            if (e.target.id === 'addShiftForm') {
                addShift();
                e.target.reset();
            }
        });

        function addShift() {
            const staffId = document.getElementById('shiftStaff').value;
            const clientId = document.getElementById('shiftClient').value;
            const staffMember = staff.find(s => s.id == staffId);
            const client = clients.find(c => c.id == clientId);
            
            if (!staffMember || !client) {
                showAlert('Please select both staff and client', 'error');
                return;
            }
            
            const newShift = {
                id: Date.now(),
                staffId: staffId,
                staffName: staffMember.name,
                clientId: clientId,
                clientName: client.name,
                date: document.getElementById('shiftDate').value,
                startTime: document.getElementById('shiftStartTime').value,
                endTime: document.getElementById('shiftEndTime').value,
                type: document.getElementById('shiftType').value,
                notes: document.getElementById('shiftNotes').value,
                status: 'Scheduled'
            };
            
            shifts.push(newShift);
            localStorage.setItem('careflow_shifts', JSON.stringify(shifts));
            updateRotaView();
            updateDashboardStats();
            closeModal('addShiftModal');
            showAlert('Shift added successfully!', 'success');
        }

        // Reports
        function generateReport(reportType) {
            showAlert(`Generating ${reportType} report...`, 'success');
            
            setTimeout(() => {
                const reportData = {
                    'care-logs': 'Care logs for the past month have been compiled.',
                    'medication': 'Medication administration records exported.',
                    'incidents': 'Incident reports and analysis completed.',
                    'staff-hours': 'Staff working hours and overtime report generated.',
                    'compliance': 'Compliance audit report ready for review.',
                    'custom': 'Custom report generated based on your criteria.'
                };
                
                showAlert(reportData[reportType] || 'Report generated successfully!', 'success');
            }, 1500);
        }

        // System Functions
        function performBackup() {
            showAlert('System backup initiated...', 'success');
            
            setTimeout(() => {
                document.getElementById('lastBackup').textContent = new Date().toLocaleString();
                showAlert('Backup completed successfully!', 'success');
            }, 2000);
        }

        function logout() {
            if (confirm('Are you sure you want to logout?')) {
                showAlert('Logging out...', 'success');
                setTimeout(() => {
                    window.location.reload();
                }, 1000);
            }
        }

        // Populate staff dropdown
        function populateStaffDropdown() {
            // This function is called when needed
        }
    </script>
</body>
</html>
                